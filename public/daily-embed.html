<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ¯æ—¥ä»»å‹™ï¼ˆEmbedï¼‰</title>
  <!-- æ²¿ç”¨åŸæœ‰æ¨£å¼èˆ‡è³‡æ–™é‚è¼¯ -->
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* è®“åšç‚ºå´æ¬„åµŒå…¥æ™‚æ›´ä¹¾æ·¨ */
    body{ background:transparent; }
    .page-wrapper{ padding:0; background:transparent; }
    h2{ display:flex; align-items:center; gap:.5rem; margin:8px 0 12px; }
    .date-nav{ display:flex; flex-wrap:wrap; gap:10px; margin:10px 0 14px; }
    .date-nav button{ padding:6px 12px; border-radius:12px; border:1px solid #f5a5bd; background:#fff; cursor:pointer; }
    .date-nav button:hover{ background:#ffe8f0; }
    .date-display{ display:none !important; } /* ä¸é¡¯ç¤ºã€Œ2025/09/23ã€é‚£ä¸€è¡Œ */
  </style>
  <!-- ä¿ç•™åŸæœ¬çš„ daily.jsï¼Œè®“å®ƒä»¥ #datePicker / #task-display ç¹¼çºŒé‹ä½œ -->
  <script type="module" src="js/daily.js" defer></script>
</head>
<body>
  <div class="page-wrapper">
    <!-- 1) æ¨™é¡Œæ”¹ç‚ºã€Œæ¯æ—¥ä»»å‹™ã€ï¼Œä¿ç•™æ—¥æ›† -->
    <h2>ğŸ“… æ¯æ—¥ä»»å‹™ <input type="date" id="datePicker" /></h2>

    <!-- 2) æ‹¿æ‰é¡¯ç¤ºã€Œç•¶å¤©æ—¥æœŸã€çš„è¡Œï¼ˆä»ä¿ç•™ç¯€é»é¿å…æ—¢æœ‰ JS ä¾è³´ï¼‰ -->
    <div id="selectedDate" class="date-display"></div>

    <!-- 3) å¿«é€Ÿåˆ‡æ›ï¼šä»Šå¤©ã€å‰1~å‰5å¤©ï¼ˆå…± 6 é¡†ï¼‰ï¼Œä¸æ”¾ã€Œå‰6å¤©ã€ -->
    <div class="date-nav" id="date-nav">
      <button data-offset="0">ä»Šå¤©</button>
      <button data-offset="1">å‰1å¤©</button>
      <button data-offset="2">å‰2å¤©</button>
      <button data-offset="3">å‰3å¤©</button>
      <button data-offset="4">å‰4å¤©</button>
      <button data-offset="5">å‰5å¤©</button>
    </div>

    <!-- 4) ä»»å‹™æ¸…å–®å®¹å™¨ï¼ˆæ²¿ç”¨åŸ ID è®“ daily.js æ¸²æŸ“ï¼‰ -->
    <div class="task-display" id="task-display"></div>
  </div>

  <script>
    // ===== Embed è¡Œç‚ºï¼šåˆå§‹åŒ–æ—¥æœŸã€è™•ç† 6 é¡†å¿«é€Ÿåˆ‡æ›ã€èˆ‡åŸ daily.js å”ä½œ =====
    (function(){
      const $ = (sel) => document.querySelector(sel);
      const dateInput = $('#datePicker');
      const nav = $('#date-nav');

      function toYMD(d){
        const y = d.getFullYear();
        const m = String(d.getMonth()+1).padStart(2,'0');
        const day = String(d.getDate()).padStart(2,'0');
        return `${y}-${m}-${day}`;
      }
      function fromYMD(s){
        const m = s.match(/^(\d{4})[-/](\d{2})[-/](\d{2})$/);
        if(!m) return null;
        return new Date(Number(m[1]), Number(m[2])-1, Number(m[3]));
      }
      function setDateByOffset(days){
        const base = dateInput.value ? fromYMD(dateInput.value) : new Date();
        const d = new Date(base);
        d.setDate(d.getDate() - days);
        dateInput.value = toYMD(d);
        // é€šçŸ¥åŸ daily.js ä»¥ç›®å‰æ—¥æœŸé‡æ–°æ¸²æŸ“
        dateInput.dispatchEvent(new Event('input', { bubbles:true }));
        dateInput.dispatchEvent(new Event('change', { bubbles:true }));
      }

      // è®€å– URL ?date=YYYY-MM-DD æˆ–ç”¨ä»Šå¤©
      const url = new URL(location.href);
      const urlDate = url.searchParams.get('date');
      const init = urlDate ? fromYMD(urlDate.replaceAll('/','-')) : new Date();
      dateInput.value = toYMD(init);

      // é»å¿«é€Ÿéµ â†’ æ›´æ–° datePicker
      nav.addEventListener('click', (e)=>{
        const btn = e.target.closest('button[data-offset]');
        if(!btn) return;
        const offset = Number(btn.getAttribute('data-offset') || '0');
        setDateByOffset(offset);
      });

      // åˆå§‹è§¸ç™¼ä¸€æ¬¡ï¼Œè®“ daily.js è®€åˆ°ç›®å‰æ—¥æœŸ
      dateInput.dispatchEvent(new Event('input', { bubbles:true }));
      dateInput.dispatchEvent(new Event('change', { bubbles:true }));
    })();
  </script>
</body>
</html>
