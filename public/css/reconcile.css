:root{--pink:#ff7fb6;--soft:#ffe7f1;--ink:#2b2b2b;--muted:#6b7280;--ok:#10b981;--bad:#ef4444;--overlay:rgba(17,24,39,.6)}
*{box-sizing:border-box}
body{font-family:"Noto Sans TC","Microsoft JhengHei",Arial,sans-serif;margin:0;background:#fff;color:var(--ink)}
header{background:#fff;border-bottom:1px solid #eee;position:sticky;top:0;z-index:10}
.wrap{max-width:1100px;margin:0 auto;padding:14px}
h1{font-size:20px;margin:8px 0;display:flex;gap:8px;align-items:center}
.tag{font-size:12px;background:#ffeff7;color:#bf206a;padding:2px 8px;border-radius:999px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.card{background:#fff;border:1px solid #eee;border-radius:14px;padding:12px;box-shadow:0 4px 16px rgba(0,0,0,.04)}
.btn{background:var(--pink);color:#fff;border:none;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:600}
.btn.outline{background:#fff;color:#bf206a;border:1px solid #f5b6d2}
.small{font-size:12px;color:var(--muted)}
input[type="file"],select,input[type='number'],input[type='text']{padding:8px;border:1px solid #e5e7eb;border-radius:10px;font:inherit}
table{border-collapse:collapse;width:100%;font-size:13px}
th,td{border-bottom:1px solid #f1f1f1;padding:6px 8px;text-align:left}
th{background:#fff9fc;position:sticky;top:0;z-index:2}
tr:hover{background:#fff5fb}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.row .grow{flex:1 1 auto}
.pill{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px}
.pill.ok{background:#e6fbf4;color:#047857}
.pill.bad{background:#fee2e2;color:#991b1b}
.progress{height:8px;background:#eee;border-radius:999px;overflow:hidden}
.bar{height:100%;background:var(--pink);width:0%}
.groupRow td{background:#faf5ff;font-weight:700;border-top:2px solid #e9d5ff}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
.totals{display:flex;gap:18px;justify-content:flex-end;margin-top:8px}
.totals .mono{min-width:120px;text-align:right}
.diff-pos{color:#ef4444}
.diff-zero{color:#10b981}

/* ---- Overlay 修正 ---- */
#mgrOverlay{position:fixed;inset:0;background:var(--overlay);display:none;align-items:center;justify-content:center;z-index:999999;-webkit-overflow-scrolling:touch}
#mgrSheet{width:min(1000px,96vw);height:min(680px,90vh);background:#fff;border-radius:16px;box-shadow:0 10px 40px rgba(0,0,0,.24);display:flex;flex-direction:column;overflow:hidden;position:relative;z-index:1000000;isolation:isolate}
#mgrSheet header{position:relative;border-bottom:1px solid #eee;z-index:2}
#mgrSheet iframe{border:0;width:100%;height:100%;position:relative;z-index:1}

/* 防止外層 transform 影響 stacking */
html,body{position:relative;z-index:0;isolation:isolate}